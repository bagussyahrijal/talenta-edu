import{K as ne,r as i,j as e,L as D,$ as K,S as ce}from"./app-DbpzdwFL.js";import{B as d}from"./button-nsSqORs2.js";import{C as de}from"./checkbox-qbAzKmG-.js";import{I as N}from"./input-GGR-33Of.js";import{L as g}from"./label-CJg2QrTt.js";import{S as O}from"./separator-DjZCV5-r.js";import{T as me,a as pe,b as xe,c as fe}from"./tabs-8ZUNTxS_.js";import{U as B}from"./user-layout-BGVxSrPd.js";import{t as E}from"./index-adnqAMSx.js";import{U as $}from"./user-CtC4W_DT.js";import{B as J}from"./badge-check-CZ8-4okF.js";import{H as ue}from"./hourglass-BNQVoG82.js";import{C as X}from"./check-BUnQtbm6.js";import{X as he}from"./x-Ck5JSsba.js";/* empty css            */import"./index-muyUwSbg.js";import"./index-BKZ60sTg.js";import"./utils-t30SwFLs.js";import"./index-Czgf-KsJ.js";import"./index-BNGjsBO4.js";import"./index-BrWH3fgz.js";import"./index-BBYaHc3j.js";import"./floating-ui.react-dom-GTqUnYaj.js";import"./index-BlfYzGKu.js";import"./index-DQnLm8Kj.js";import"./sonner-BVDcOtMc.js";import"./breadcrumbs-BB8Ncwy_.js";import"./createLucideIcon-C4hA1fDf.js";import"./index-DLFvmWB3.js";import"./Combination-BfBk5v_5.js";import"./tooltip-BP3-rQs1.js";import"./index-BG9WF58p.js";import"./dropdown-menu-2YdbIEK2.js";import"./index-DWIaYFCs.js";import"./avatar-COyTLtDN.js";import"./use-initials-QSx-oft4.js";import"./chevron-right-B5kzfHcg.js";import"./icon-DkYG_jat.js";import"./chevron-down-qOg5Thj1.js";import"./popover-ByDDj6AP.js";import"./badge-DhvWYlS3.js";import"./command-Dld5evAu.js";import"./dialog-CupH4Hmp.js";import"./search-Bb5VI_Ga.js";import"./circle-check-big-BY52VMjX.js";import"./clock-JumJjszk.js";import"./monitor-play-BpYKtXm7.js";import"./presentation-CbszFwHd.js";import"./house-CctVEg_T.js";import"./file-text-CQepP0w_.js";function ge(o){if(!o)return[];const k=o.match(/<li>(.*?)<\/li>/g);return k?k.map(j=>j.replace(/<\/?li>/g,"").trim()):[]}function ft({webinar:o,hasAccess:k,pendingInvoiceUrl:j,referralInfo:m}){var H;const{auth:R}=ne().props,M=!!R.user,v=M&&((H=R.user)==null?void 0:H.phone_number),[S,V]=i.useState(!1),[b,x]=i.useState(!1),[p,Y]=i.useState(""),[s,_]=i.useState(null),[I,U]=i.useState(!1),[F,f]=i.useState(""),[Q,W]=i.useState(!1),[n,P]=i.useState({ig_follow_proof:null,tag_friend_proof:null,tiktok_follow_proof:null}),[c,u]=i.useState({ig_follow_proof:!1,tag_friend_proof:!1,tiktok_follow_proof:!1}),Z=ge(o.benefits),l=o.price===0,T=5e3,ee=o.price,te=(s==null?void 0:s.discount_amount)||0,q=ee-te,G=l?0:q+T;i.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("ref");a?sessionStorage.setItem("referral_code",a):m.code&&sessionStorage.setItem("referral_code",m.code)},[m]),i.useEffect(()=>{if(!p.trim()||l){_(null),f("");return}const t=setTimeout(()=>{ae()},500);return()=>clearTimeout(t)},[p]);const ae=async()=>{var t;if(!(!p.trim()||l)){U(!0),f("");try{const r=await(await fetch("/api/discount-codes/validate",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.content)||""},credentials:"same-origin",body:JSON.stringify({code:p,amount:o.price,product_type:"webinar",product_id:o.id})})).json();r.valid?(_(r),f("")):(_(null),f(r.message||"Kode promo tidak valid"))}catch{_(null),f("Terjadi kesalahan saat memvalidasi kode promo")}finally{U(!1)}}},re=async()=>{try{const a=await(await fetch("/csrf-token",{method:"GET",credentials:"same-origin"})).json(),r=document.querySelector('meta[name="csrf-token"]');return r&&(r.content=a.token),a.token}catch(t){throw console.error("Failed to refresh CSRF token:",t),t}},se=t=>{if(t.preventDefault(),!v){alert("Profil Anda belum lengkap! Harap lengkapi nomor telepon terlebih dahulu."),window.location.href=route("profile.edit");return}if(!n.ig_follow_proof||!n.tag_friend_proof||!n.tiktok_follow_proof){alert("Harap upload semua bukti follow dan tag yang diperlukan!");return}x(!0);const a=new FormData;a.append("type","webinar"),a.append("id",o.id),a.append("ig_follow_proof",n.ig_follow_proof),a.append("tag_friend_proof",n.tag_friend_proof),a.append("tiktok_follow_proof",n.tiktok_follow_proof),ce.post(route("enroll.free"),a,{onError:r=>{alert(r.message||"Gagal mendaftar webinar gratis.")},onFinish:()=>{x(!1)}})},oe=async t=>{if(t.preventDefault(),!v){alert("Profil Anda belum lengkap! Harap lengkapi nomor telepon terlebih dahulu."),window.location.href=route("profile.edit");return}if(!S&&!l){alert("Anda harus menyetujui syarat dan ketentuan!");return}if(x(!0),l){W(!0),x(!1);return}const a=async(r=0)=>{var z;const h=o.strikethrough_price>0?o.strikethrough_price-o.price:0,ie=(s==null?void 0:s.discount_amount)||0,A={type:"webinar",id:o.id,discount_amount:h+ie,nett_amount:q,transaction_fee:T,total_amount:G};s!=null&&s.valid&&(A.discount_code_id=s.discount_code.id,A.discount_code_amount=s.discount_amount);try{const y=(z=document.querySelector('meta[name="csrf-token"]'))==null?void 0:z.content,L=await fetch(route("invoice.store"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":y||"",Accept:"application/json"},credentials:"same-origin",body:JSON.stringify(A)});if(L.status===419&&r<2)return console.log(`CSRF token expired, refreshing... (attempt ${r+1})`),await re(),a(r+1);const w=await L.json();if(L.ok&&w.success)if(w.payment_url)window.location.href=w.payment_url;else throw new Error("Payment URL not received");else throw new Error(w.message||"Gagal membuat invoice.")}catch(y){throw console.error("Payment error:",y),y}};try{await a()}catch(r){alert(r.message||"Terjadi kesalahan saat proses pembayaran."),x(!1)}},le=(t,a=2)=>{const r=a*1024*1024;return t.size<=r},C=(t,a)=>{if(!a){P(r=>({...r,[t]:null})),u(r=>({...r,[t]:!1}));return}if(!le(a,2)){u(h=>({...h,[t]:!0}));const r=document.querySelector(`input[data-field="${t}"]`);r&&(r.value=""),E.error("Ukuran file terlalu besar. Maksimal 2MB.");return}if(!a.type.startsWith("image/")){u(h=>({...h,[t]:!0}));const r=document.querySelector(`input[data-field="${t}"]`);r&&(r.value=""),E.error("Hanya file gambar (JPG, PNG, GIF, dll) yang diperbolehkan.");return}P(r=>({...r,[t]:a})),u(r=>({...r,[t]:!1})),E.success("File berhasil diunggah.")};if(!M){const t=window.location.href,a=route("login",{redirect:t});return e.jsxs(B,{children:[e.jsx(D,{title:"Login Required"}),e.jsx("section",{className:"to-primary w-full bg-gradient-to-tl from-black px-4",children:e.jsxs("div",{className:"mx-auto my-12 w-full max-w-7xl px-4",children:[e.jsxs("h2",{className:"mx-auto mb-4 max-w-3xl bg-gradient-to-r from-[#71D0F7] via-white to-[#E6834A] bg-clip-text text-center text-3xl font-bold text-transparent italic sm:text-4xl",children:['Daftar Webinar "',o.title,'"']}),e.jsx("p",{className:"text-center text-gray-400",children:"Silakan login terlebih dahulu untuk mendaftar webinar."})]})}),e.jsx("section",{className:"mx-auto my-4 w-full max-w-7xl px-4",children:e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx($,{size:64,className:"text-blue-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Login Diperlukan"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Anda perlu login terlebih dahulu untuk mendaftar webinar ini.",m.hasActive&&" Kode referral Anda akan tetap tersimpan."]}),e.jsxs("div",{className:"flex w-full max-w-md gap-2",children:[e.jsx(d,{asChild:!0,className:"flex-1",children:e.jsx("a",{href:a,children:"Login"})}),e.jsx(d,{asChild:!0,variant:"outline",className:"flex-1",children:e.jsx(K,{href:route("register",m.code?{ref:m.code}:{}),children:"Daftar"})})]})]})})]})}return v?e.jsxs(B,{children:[e.jsx(D,{title:"Daftar Webinar"}),e.jsx("section",{className:"to-primary w-full bg-gradient-to-tl from-black px-4",children:e.jsxs("div",{className:"mx-auto my-12 w-full max-w-7xl px-4",children:[e.jsxs("h2",{className:"mx-auto mb-4 max-w-3xl bg-gradient-to-r from-[#71D0F7] via-white to-[#E6834A] bg-clip-text text-center text-3xl font-bold text-transparent italic sm:text-4xl",children:['Daftar Webinar "',o.title,'"']}),e.jsx("p",{className:"text-center text-gray-400",children:l?"Silahkan lengkapi persyaratan berikut untuk mendaftar webinar.":"Silakan selesaikan pembayaran untuk mendaftar webinar."})]})}),e.jsx("section",{className:"mx-auto my-4 w-full max-w-7xl px-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3 lg:gap-6",children:[e.jsxs(me,{defaultValue:"detail",className:"lg:col-span-2",children:[e.jsx(pe,{children:e.jsx(xe,{value:"detail",children:"Detail Webinar"})}),e.jsx(fe,{value:"detail",children:e.jsxs("div",{className:"h-full rounded-lg border p-4",children:[e.jsx("h2",{className:"text-3xl font-bold italic",children:"Yang akan kamu dapatkan"}),e.jsx("p",{className:"mt-2 mb-4 text-sm text-gray-600",children:"Manfaat yang akan kamu peroleh setelah mengikuti webinar ini."}),e.jsx("ul",{className:"space-y-2",children:Z.map((t,a)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(J,{size:18,className:"mt-1 min-w-6 text-green-600"}),e.jsx("p",{children:t})]},a))})]})})]}),k?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx(J,{size:64,className:"text-green-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Anda Sudah Memiliki Akses"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Anda sudah terdaftar di webinar ini. Silakan masuk ke dalam grup."}),e.jsx(d,{asChild:!0,className:"w-full",children:e.jsx("a",{href:o.group_url??"",target:"_blank",rel:"noopener noreferrer",children:"Masuk Group Webinar"})})]}):j?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx(ue,{size:64,className:"text-yellow-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Pembayaran Tertunda"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Anda memiliki pembayaran yang belum selesai untuk webinar ini. Silakan lanjutkan untuk membayar."}),e.jsx(d,{asChild:!0,className:"w-full",children:e.jsx("a",{href:j,children:"Lanjutkan Pembayaran"})})]}):Q?e.jsxs("form",{onSubmit:se,children:[e.jsx("h2",{className:"my-2 text-xl font-bold italic",children:"Upload Bukti Follow"}),e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"ig_follow_proof",children:"Bukti Follow Instagram"}),e.jsx(N,{id:"ig_follow_proof","data-field":"ig_follow_proof",type:"file",accept:"image/*",onChange:t=>{var a;return C("ig_follow_proof",((a=t.target.files)==null?void 0:a[0])||null)},className:c.ig_follow_proof?"border-red-500 focus:ring-red-500":"",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Screenshot halaman profil Instagram kami yang menunjukkan Anda sudah follow (Maks. 2MB)"}),c.ig_follow_proof&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:"File tidak valid. Pastikan ukuran tidak melebihi 2MB dan format gambar."})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"tiktok_follow_proof",children:"Bukti Follow TikTok"}),e.jsx(N,{id:"tiktok_follow_proof","data-field":"tiktok_follow_proof",type:"file",accept:"image/*",onChange:t=>{var a;return C("tiktok_follow_proof",((a=t.target.files)==null?void 0:a[0])||null)},className:c.tiktok_follow_proof?"border-red-500 focus:ring-red-500":"",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Screenshot halaman profil TikTok kami yang menunjukkan Anda sudah follow (Maks. 2MB)"}),c.tiktok_follow_proof&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:"File tidak valid. Pastikan ukuran tidak melebihi 2MB dan format gambar."})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"tag_friend_proof",children:"Bukti Tag 3 Teman di Instagram"}),e.jsx(N,{id:"tag_friend_proof","data-field":"tag_friend_proof",type:"file",accept:"image/*",onChange:t=>{var a;return C("tag_friend_proof",((a=t.target.files)==null?void 0:a[0])||null)},className:c.tag_friend_proof?"border-red-500 focus:ring-red-500":"",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Screenshot postingan Instagram kami yang menunjukkan Anda sudah tag 3 teman di komentar (Maks. 2MB)"}),c.tag_friend_proof&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:"File tidak valid. Pastikan ukuran tidak melebihi 2MB dan format gambar."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>{W(!1),u({ig_follow_proof:!1,tag_friend_proof:!1,tiktok_follow_proof:!1}),P({ig_follow_proof:null,tag_friend_proof:null,tiktok_follow_proof:null})},className:"flex-1",children:"Kembali"}),e.jsx(d,{type:"submit",disabled:b||!n.ig_follow_proof||!n.tag_friend_proof||!n.tiktok_follow_proof||c.ig_follow_proof||c.tag_friend_proof||c.tiktok_follow_proof,className:"flex-1",children:b?"Memproses...":"Dapatkan Akses Gratis"})]})]})]}):e.jsxs("form",{onSubmit:oe,children:[e.jsxs("h2",{className:"my-2 text-xl font-bold italic",children:["Detail ",l?"Pendaftaran":"Pembayaran"]}),e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[l?e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("div",{className:"flex items-center justify-between p-4",children:e.jsx("span",{className:"w-full text-2xl font-bold text-green-600",children:"WEBINAR GRATIS"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Untuk mendapatkan akses gratis, Anda perlu:"}),e.jsxs("ul",{className:"space-y-1 text-left text-sm",children:[e.jsxs("li",{children:["• Follow Instagram kami"," ",e.jsx("a",{href:"https://www.instagram.com/aksarateknologi/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"@aksarateknologi"})," ",e.jsx("a",{href:"https://www.instagram.com/aksademy/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"@aksademy"})]}),e.jsxs("li",{children:["• Follow TikTok kami"," ",e.jsx("a",{href:"https://www.tiktok.com/@aksarateknologimandiri",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"@aksarateknologi"})]}),e.jsx("li",{children:"• Tag 3 teman di postingan Instagram kami"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload bukti follow dan tag untuk mendapatkan akses"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"promo-code",children:"Kode Promo (Opsional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{id:"promo-code",type:"text",placeholder:"Masukkan kode promo",value:p,onChange:t=>Y(t.target.value.toUpperCase()),className:"pr-10"}),I&&e.jsx("div",{className:"absolute top-1/2 right-3 -translate-y-1/2 transform",children:e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-blue-600"})}),!I&&p&&e.jsx("div",{className:"absolute top-1/2 right-3 -translate-y-1/2 transform",children:s!=null&&s.valid?e.jsx(X,{className:"h-4 w-4 text-green-600"}):F?e.jsx(he,{className:"h-4 w-4 text-red-600"}):null})]}),F&&e.jsx("p",{className:"text-sm text-red-600",children:F}),(s==null?void 0:s.valid)&&e.jsxs("div",{className:"rounded-lg border border-green-200 bg-green-50 p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-green-600"}),e.jsxs("p",{className:"text-sm font-medium text-green-800",children:['Kode promo "',s.discount_code.code,'" berhasil diterapkan!']})]}),e.jsxs("p",{className:"mt-1 text-xs text-green-600",children:[s.discount_code.name," - Diskon ",s.discount_code.formatted_value]})]})]}),e.jsxs("div",{className:"space-y-2 rounded-lg border p-4",children:[o.strikethrough_price>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Harga Asli"}),e.jsxs("span",{className:"font-semibold text-gray-500 line-through",children:["Rp ",o.strikethrough_price.toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Diskon"}),e.jsxs("span",{className:"font-semibold text-red-500",children:["-Rp ",(o.strikethrough_price-o.price).toLocaleString("id-ID")]})]}),e.jsx(O,{className:"my-2"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Harga Webinar"}),e.jsxs("span",{className:"font-semibold text-gray-500",children:["Rp ",o.price.toLocaleString("id-ID")]})]}),(s==null?void 0:s.valid)&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:["Diskon Promo (",s.discount_code.code,")"]}),e.jsxs("span",{className:"font-semibold text-green-600",children:["-Rp ",s.discount_amount.toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Biaya Transaksi"}),e.jsxs("span",{className:"font-semibold text-gray-500",children:["Rp ",T.toLocaleString("id-ID")]})]}),e.jsx(O,{className:"my-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Total Pembayaran"}),e.jsxs("span",{className:"text-primary text-xl font-bold",children:["Rp ",G.toLocaleString("id-ID")]})]})]})]}),!l&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(de,{id:"terms",checked:S,onCheckedChange:t=>V(t===!0)}),e.jsxs(g,{htmlFor:"terms",children:["Saya menyetujui"," ",e.jsx("a",{href:"/terms-and-conditions",target:"_blank",rel:"noopener noreferrer",className:"text-blue-700 hover:underline",children:"syarat dan ketentuan"})]})]}),e.jsx(d,{className:"w-full",type:"submit",disabled:(l?!1:!S)||b,children:b?"Memproses...":l?"Upload Bukti Follow":"Lanjutkan Pembayaran"})]})]})]})})]}):e.jsxs(B,{children:[e.jsx(D,{title:"Daftar Webinar"}),e.jsx("section",{className:"to-primary w-full bg-gradient-to-tl from-black px-4",children:e.jsxs("div",{className:"mx-auto my-12 w-full max-w-7xl px-4",children:[e.jsxs("h2",{className:"mx-auto mb-4 max-w-3xl bg-gradient-to-r from-[#71D0F7] via-white to-[#E6834A] bg-clip-text text-center text-3xl font-bold text-transparent italic sm:text-4xl",children:['Daftar Webinar "',o.title,'"']}),e.jsx("p",{className:"text-center text-gray-400",children:"Silakan lengkapi profil Anda terlebih dahulu."})]})}),e.jsx("section",{className:"mx-auto my-4 w-full max-w-7xl px-4",children:e.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-4 rounded-lg border p-6 text-center",children:[e.jsx($,{size:64,className:"text-orange-500"}),e.jsx("h2",{className:"text-xl font-bold",children:"Profil Belum Lengkap"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Profil Anda belum lengkap! Harap lengkapi nomor telepon terlebih dahulu untuk mendaftar webinar."}),e.jsx(d,{asChild:!0,className:"w-full max-w-md",children:e.jsx(K,{href:route("profile.edit",{redirect:window.location.href}),children:"Lengkapi Profil"})})]})})]})}export{ft as default};
