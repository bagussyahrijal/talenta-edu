import{r as w,j as e,L as P,$ as n}from"./app-CVVm-dmT.js";import{A as i,a as d}from"./alert-xVnSaTvg.js";import{A as T,a as A,b as I,c as R,d as B,e as z,f as F,g as E,h as O}from"./alert-dialog-DqUd3ckm.js";import{B as r}from"./button-BpLRUxmy.js";import{U as $,H as K}from"./user-layout-DLydcaVp.js";import{t as m}from"./index-DwJ6OYQF.js";import{E as N}from"./external-link-Cro7aBa-.js";import{C as k}from"./clock-DHi_SIc-.js";import{C as o}from"./circle-x-XIhaTw1f.js";import{F as M}from"./file-text-8ijIQhvf.js";import{T as H}from"./triangle-alert-Dhd26Dzy.js";import{C as v}from"./circle-check-big-f4WAHRJj.js";/* empty css            */import"./index--TSzGvJj.js";import"./utils-DCiIK_P1.js";import"./index-CyhKApP_.js";import"./index--otffRn6.js";import"./index-DBd60DY_.js";import"./Combination-gFizosoD.js";import"./sonner-CMCodNR5.js";import"./breadcrumbs-3TB7whTK.js";import"./createLucideIcon-P8ST4-10.js";import"./x-BvgZU4Ue.js";import"./tooltip-Cc_iO7aH.js";import"./index-D1qo2ZnF.js";import"./index-MtptFKCE.js";import"./index-9OPLbsqM.js";import"./index-CV4pI6Yp.js";import"./floating-ui.react-dom-C7jZIp_N.js";import"./index-C98Hu0lW.js";import"./index-BJa7toLU.js";import"./dropdown-menu-BYp8Zl6f.js";import"./index-CcAZXtNa.js";import"./check-BiEfxybp.js";import"./avatar-BRxmG75R.js";import"./use-initials-BkPTl5OE.js";import"./user-Byw1s2Ru.js";import"./icon-cw6hu7K4.js";import"./chevron-down-Cl5pAJCQ.js";import"./popover-C793obIJ.js";import"./badge-CxDk48hU.js";import"./command-Cj9ZCoVp.js";import"./dialog-DPyJHOzS.js";import"./search-DzD6dos_.js";import"./presentation-BKTk79bn.js";function Ee({invoice:a}){var j,f,b;const[c,x]=w.useState(!1),[_,h]=w.useState(!1),l=a.expires_at&&new Date>new Date(a.expires_at),p=a.expires_at?new Date(a.expires_at).getTime()-new Date().getTime():0,D=Math.floor(p/(1e3*60*60)),C=Math.floor(p%(1e3*60*60)/(1e3*60)),s=(()=>{if(a.course_items&&a.course_items.length>0){const t=a.course_items[0].course;return{type:"course",name:t.title,slug:t.slug,thumbnail:t.thumbnail,profileRoute:"profile.course.detail",publicRoute:"course.detail"}}else if(a.bootcamp_items&&a.bootcamp_items.length>0){const t=a.bootcamp_items[0].bootcamp;return{type:"bootcamp",name:t.title,slug:t.slug,thumbnail:t.thumbnail,profileRoute:"profile.bootcamp.detail",publicRoute:"bootcamp.detail"}}else if(a.webinar_items&&a.webinar_items.length>0){const t=a.webinar_items[0].webinar;return{type:"webinar",name:t.title,slug:t.slug,thumbnail:t.thumbnail,profileRoute:"profile.webinar.detail",publicRoute:"webinar.detail"}}return null})(),S=async()=>{var t;x(!0),h(!1);try{const y=await(await fetch(route("invoice.cancel",{id:a.id}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.content)||""}})).json();y.success?(m.success("Pesanan berhasil dibatalkan dan invoice telah dinonaktifkan."),window.location.reload()):m.error(y.message||"Gagal membatalkan pesanan.")}catch{m.error("Terjadi kesalahan saat membatalkan pesanan.")}finally{x(!1)}},L=()=>{switch(a.status){case"paid":return e.jsx(v,{className:"mt-1 h-6 w-6 text-green-500"});case"pending":return e.jsx(k,{className:"mt-1 h-6 w-6 text-yellow-500"});case"failed":return e.jsx(o,{className:"mt-1 h-6 w-6 text-red-500"});default:return e.jsx(H,{className:"mt-1 h-6 w-6 text-gray-500"})}},u=()=>{switch(a.status){case"paid":return"Pembayaran Berhasil";case"pending":return l?"Pembayaran Kedaluwarsa":"Menunggu Pembayaran";case"failed":return"Pembayaran Dibatalkan";default:return"Status Tidak Diketahui"}},g=()=>{switch(a.status){case"paid":return"text-green-600";case"pending":return l?"text-red-600":"text-yellow-600";case"failed":return"text-red-600";default:return"text-gray-600"}};return e.jsxs($,{children:[e.jsx(P,{title:`Invoice ${a.invoice_code}`}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-4 md:py-8 dark:bg-gray-900",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4",children:e.jsxs("div",{className:"overflow-hidden rounded-lg bg-white shadow-lg dark:bg-gray-800",children:[e.jsxs("div",{className:"to-primary flex gap-3 bg-gradient-to-tl from-black px-6 py-4 text-white",children:[L(),e.jsxs("div",{children:[e.jsx("h1",{className:`text-xl font-bold md:text-2xl ${g()}`,children:u()}),e.jsxs("p",{className:"mt-1 text-sm text-blue-100 md:text-base",children:["Invoice #",a.invoice_code]})]})]}),e.jsxs("div",{className:"p-6",children:[s&&e.jsxs("div",{className:"mb-6 rounded-lg border bg-gray-50 p-4 dark:border-gray-600 dark:bg-gray-700",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-900 dark:text-white",children:"Produk yang Dibeli"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("img",{src:s.thumbnail?`/storage/${s.thumbnail}`:"/assets/images/placeholder.png",alt:s.name,className:"h-16 rounded-lg object-cover md:h-20"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 capitalize dark:text-gray-400",children:s.type==="course"?"Kelas Online":s.type==="bootcamp"?"Bootcamp":"Webinar"}),e.jsx("div",{className:"mt-2 flex flex-col gap-2 sm:flex-row",children:a.status==="paid"?e.jsx(r,{asChild:!0,size:"sm",variant:"outline",children:e.jsxs(n,{href:route(s.profileRoute,{[s.type]:s.slug}),children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),"Buka di Profile"]})}):e.jsx(r,{asChild:!0,size:"sm",variant:"ghost",children:e.jsxs(n,{href:route(s.publicRoute,{[s.type]:s.slug}),children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),"Lihat Detail Produk"]})})})]})]})]}),a.status==="pending"&&!l&&e.jsxs(i,{className:"mb-6 border-yellow-200 bg-yellow-50",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx(d,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("span",{children:["Pembayaran akan kedaluwarsa dalam ",D," jam ",C," menit."]})})})]}),a.status==="pending"&&l&&e.jsxs(i,{className:"mb-6 border-red-200 bg-red-50",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx(d,{children:"Invoice ini sudah kedaluwarsa dan tidak dapat dibayar lagi. Silakan buat pesanan baru."})]}),a.status==="failed"&&e.jsxs(i,{className:"mb-6 border-red-200 bg-red-50",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx(d,{children:"Invoice ini telah dibatalkan dan tidak dapat dibayar lagi. Silakan buat pesanan baru jika masih ingin membeli."})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-900 dark:text-white",children:"Detail Pembayaran"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[a.discount_amount>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Harga Asli:"}),e.jsxs("span",{className:"medium",children:["Rp ",(a.discount_amount+a.nett_amount).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Diskon:"}),e.jsxs("span",{className:"text-gray-500 line-through",children:["Rp ",((j=a.discount_amount)==null?void 0:j.toLocaleString("id-ID"))||"0"]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Subtotal:"}),e.jsxs("span",{className:"font-medium",children:["Rp ",((f=a.nett_amount)==null?void 0:f.toLocaleString("id-ID"))||"0"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Biaya Transaksi:"}),e.jsxs("span",{className:"font-medium",children:["Rp ",((a.amount||0)-(a.nett_amount||0)).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 text-lg font-semibold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["Rp ",((b=a.amount)==null?void 0:b.toLocaleString("id-ID"))||"0"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold text-gray-900 dark:text-white",children:"Informasi Pembayaran"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`font-medium ${g()}`,children:u()})]}),a.payment_method&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Metode:"}),e.jsx("span",{className:"font-medium",children:a.payment_method})]}),a.payment_channel&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Channel:"}),e.jsx("span",{className:"font-medium",children:a.payment_channel})]}),a.paid_at&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Dibayar pada:"}),e.jsx("span",{className:"font-medium",children:new Date(a.paid_at).toLocaleString("id-ID")})]}),a.expires_at&&a.status==="pending"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Kedaluwarsa:"}),e.jsx("span",{className:"font-medium",children:new Date(a.expires_at).toLocaleString("id-ID")})]})]})]})]}),e.jsxs("div",{className:"flex flex-col justify-center gap-4 sm:flex-row",children:[a.status==="pending"&&!l&&a.invoice_url&&e.jsxs(e.Fragment,{children:[e.jsx(r,{asChild:!0,size:"lg",className:"w-full sm:w-auto",children:e.jsx("a",{href:a.invoice_url,target:"_blank",rel:"noopener noreferrer",children:"Lanjutkan Pembayaran"})}),e.jsxs(T,{open:_,onOpenChange:h,children:[e.jsx(A,{asChild:!0,children:e.jsx(r,{variant:"outline",size:"lg",className:"w-full border-red-600 text-red-600 hover:bg-red-50 sm:w-auto",disabled:c,children:c?"Membatalkan...":"Batalkan Pesanan"})}),e.jsxs(I,{children:[e.jsxs(R,{children:[e.jsx(B,{children:"Batalkan Pesanan?"}),e.jsx(z,{children:"Apakah Anda yakin ingin membatalkan pesanan ini? Invoice akan dinonaktifkan dan tidak dapat dibayar lagi. Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs(F,{children:[e.jsx(E,{children:"Tidak, Pertahankan"}),e.jsx(O,{onClick:S,className:"border-red-600 bg-red-600 hover:bg-red-700",children:"Ya, Batalkan Pesanan"})]})]})]})]}),a.status==="paid"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{asChild:!0,className:"w-full sm:w-auto",variant:"outline",children:e.jsx(n,{href:route("profile.transactions"),children:"Lihat Riwayat Transaksi"})}),e.jsx(r,{asChild:!0,children:e.jsxs("a",{href:route("invoice.pdf",{id:a.id}),target:"_blank",rel:"noopener noreferrer",children:[e.jsx(M,{className:"size-4"}),"Unduh Invoice"]})})]}),(a.status==="failed"||l)&&e.jsx(r,{asChild:!0,size:"lg",className:"w-full sm:w-auto",children:e.jsxs(n,{href:route("home"),children:[e.jsx(K,{})," Kembali ke Beranda"]})})]})]})]})})})]})}export{Ee as default};
