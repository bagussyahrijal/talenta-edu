import{r as j,j as e,L as ae,S as re}from"./app-CYILbaoi.js";import{B as y}from"./button-CLlJLTlY.js";import{C as U}from"./calendar-BZq6qPrg.js";import{C as se}from"./checkbox-DPU1BMAL.js";import{C as te,a as ne,b as ie,c as le,d as oe,e as de}from"./command-BNan8g_s.js";import{u as me,F as ce,a as o,b as i,c as l,d as m,e as d,f as u}from"./form-B6atDpSa.js";import{I as p}from"./input-oXmwVgH7.js";import{L as ue}from"./label-CBpEaKXy.js";import{P as N,a as w,b as P}from"./popover-lImYfTEl.js";import{R as pe,a as O}from"./radio-group-CCoyp2HY.js";import{S as he}from"./switch-D2pMuFlz.js";import{T as B}from"./textarea-OFhD6pZ0.js";import{A as xe}from"./admin-layout-BjzJrLRA.js";import{c as k,r as A,p as K}from"./utils-D70Tm4tr.js";import{s as ge,o as je,u as fe,e as ke,b as h,n as S,c as ve,f as z,a as be,l as ye,g as _e}from"./types-DIvtpE3M.js";import{E as Ce}from"./Editor-BPkE0xhe.js";import{t as G}from"./index-cBsCYfZr.js";import{P as J}from"./package-BujP0vd5.js";import{C as Ne}from"./chevrons-up-down-LV_RtKod.js";import{C as we}from"./check-CRunFCf6.js";import{C as T}from"./calendar-HnJVVQFp.js";import{C as Pe}from"./clock-XpJ4NJ78.js";import{p as V}from"./parseISO-CfmKIOEe.js";import{f as _}from"./format-CNjBDjOL.js";import{i as W}from"./id-BLKIQCr7.js";import"./index-DMiO1qAw.js";import"./index-Dmf8IhCC.js";import"./chevron-left-BbtqFm9P.js";import"./createLucideIcon-GsIBX49w.js";import"./chevron-right-CqJIwGCr.js";import"./chevron-down-BmUU8g9g.js";import"./index-DQ7lSK2h.js";import"./index-3tGqSjMC.js";import"./index-BAlv0roY.js";import"./index-BkgLKw5P.js";import"./index-DTJuQ5a-.js";import"./index-FVdKASAH.js";import"./index-WgeQRLOk.js";import"./Combination-j_brszW9.js";import"./index-BbAmjduH.js";import"./floating-ui.react-dom-0bYVS00x.js";import"./dialog-DxQVzYhC.js";import"./x-CztZCKWT.js";import"./search-JXoM8PXj.js";import"./circle-CPY6JAuq.js";import"./sonner-CLUI3nWH.js";import"./breadcrumbs-CJXnIlNK.js";import"./tooltip-CDEoEIuX.js";import"./index-CKqWFvSI.js";import"./dropdown-menu-BWgy41d2.js";import"./index-DGU35iqQ.js";import"./avatar-D4dYc5Sq.js";import"./use-initials-C2FFciVR.js";import"./user-DXETfz_d.js";import"./app-sidebar-header-BVO0BQeh.js";import"./user-check-CE2LL8NY.js";import"./users-D_gNsYha.js";import"./presentation-DJRnJVlR.js";import"./gift-mpdk4TWt.js";import"./banknote-IH4cxJsn.js";import"./dollar-sign-BDlGQpeo.js";import"./file-text-KF7Ya-NO.js";import"./index-BljQCQMj.js";const Se=[{value:"Senin",label:"Senin"},{value:"Selasa",label:"Selasa"},{value:"Rabu",label:"Rabu"},{value:"Kamis",label:"Kamis"},{value:"Jumat",label:"Jumat"},{value:"Sabtu",label:"Sabtu"},{value:"Minggu",label:"Minggu"}],Te=je({title:h().nonempty("Judul harus diisi"),category_id:h().nonempty("Kategori harus dipilih"),short_description:h().nullable(),description:h().nullable(),key_points:h().nullable(),thumbnail:be().nullable(),registration_deadline:z({required_error:"Batas waktu pendaftaran harus diisi",invalid_type_error:"Batas waktu pendaftaran harus berupa tanggal yang valid"}),event_deadline:z().nullable().optional(),payment_code:h().nullable().optional(),duration_days:S().min(0,"Durasi tidak boleh negatif"),schedule_days:ve(h()).min(1,"Pilih minimal 1 hari"),strikethrough_price:S().min(0,"Harga tidak boleh negatif"),price:S().min(0,"Harga tidak boleh negatif"),registration_url:h().url("URL pendaftaran harus valid").nonempty("URL pendaftaran harus diisi"),type:ke(["regular","scholarship"],{required_error:"Tipe kategori harus dipilih"}),scholarship_group_link:fe([h().url("Link grup harus berupa URL yang valid"),ye(""),_e()])}).refine(s=>s.strikethrough_price>0?s.strikethrough_price>s.price:!0,{message:"Harga coret harus lebih besar dari harga normal.",path:["strikethrough_price"]});function Oa({product:s,categories:D}){const[$,L]=j.useState(!1),[F,q]=j.useState(s.strikethrough_price>0),[E,R]=j.useState(null),[Y,C]=j.useState(!1),[Q,H]=j.useState(!1),[X,I]=j.useState(!1),Z=[{title:"Sertifikasi Kerjasama",href:route("partnership-products.index")},{title:s.title,href:route("partnership-products.show",s.id)},{title:"Edit Produk",href:route("partnership-products.edit",s.id)}],n=me({resolver:ge(Te),defaultValues:{title:s.title??"",category_id:s.category_id??"",short_description:s.short_description??"",description:s.description??"",key_points:s.key_points??"",thumbnail:null,registration_deadline:s.registration_deadline?V(s.registration_deadline):void 0,event_deadline:s.event_deadline?V(s.event_deadline):void 0,payment_code:s.payment_code??"",duration_days:s.duration_days??0,schedule_days:s.schedule_days??[],strikethrough_price:s.strikethrough_price??0,price:s.price??0,registration_url:s.registration_url??"",type:s.type??"regular",scholarship_group_link:s.scholarship_group_link??""}}),M=a=>String(a).padStart(2,"0"),v=a=>a?`${M(a.getHours())}:${M(a.getMinutes())}`:"23:59",b=(a,r)=>{const[t,x]=r.split(":"),c=Number(t??0),g=Number(x??0),f=new Date(a);return f.setHours(c,g,0,0),f};function ee(a){var c,g;const r=new Date(a.registration_deadline);r.setSeconds(0,0);const t=a.event_deadline?new Date(a.event_deadline):null;t&&t.setSeconds(0,0);const x={...a,registration_deadline:_(r,"yyyy-MM-dd HH:mm:ss"),event_deadline:t?_(t,"yyyy-MM-dd HH:mm:ss"):null,payment_code:(c=a.payment_code)!=null&&c.trim()?a.payment_code.trim():null,scholarship_group_link:(g=a.scholarship_group_link)!=null&&g.trim()?a.scholarship_group_link.trim():null};re.post(route("partnership-products.update",s.id),{...x,_method:"PUT"},{forceFormData:!0})}return e.jsxs(xe,{breadcrumbs:Z,children:[e.jsx(ae,{title:`Edit Produk - ${s.title}`}),e.jsxs("div",{className:"px-4 py-4 md:px-6",children:[e.jsxs("h1",{className:"text-2xl font-semibold",children:["Edit ",s.title]}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-2xl text-sm",children:'Edit informasi produk partnership. Setelah selesai, klik tombol "Simpan Perubahan" untuk menyimpan.'}),e.jsx(ce,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(ee),className:"grid grid-cols-1 items-start gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-6 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{size:16}),e.jsx("h3",{className:"font-medium",children:"Informasi Produk"})]}),e.jsx(o,{control:n.control,name:"title",render:({field:a})=>e.jsxs(i,{children:[e.jsxs(l,{children:["Judul Produk ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{children:e.jsx(p,{placeholder:"Masukkan judul produk",...a,autoComplete:"off"})}),e.jsx(d,{})]})}),e.jsx(o,{control:n.control,name:"category_id",render:({field:a})=>{var r;return e.jsxs(i,{className:"flex flex-col",children:[e.jsxs(l,{children:["Kategori ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(N,{open:$,onOpenChange:L,children:[e.jsx(w,{asChild:!0,children:e.jsx(m,{children:e.jsxs(y,{variant:"outline",role:"combobox",className:k("justify-between",!a.value&&"text-muted-foreground"),children:[a.value?(r=D.find(t=>t.id===a.value))==null?void 0:r.name:"Pilih kategori",e.jsx(Ne,{className:"opacity-50"})]})})}),e.jsx(P,{className:"p-0",children:e.jsxs(te,{children:[e.jsx(ne,{placeholder:"Cari kategori...",className:"h-9"}),e.jsxs(ie,{children:[e.jsx(le,{children:"Tidak ada kategori ditemukan."}),e.jsx(oe,{children:D.map(t=>e.jsxs(de,{value:t.name,onSelect:()=>{n.setValue("category_id",t.id),L(!1)},children:[t.name,e.jsx(we,{className:k("ml-auto",t.id===a.value?"opacity-100":"opacity-0")})]},t.id))})]})]})})]}),e.jsx(d,{})]})}}),e.jsx(o,{control:n.control,name:"short_description",render:({field:a})=>e.jsxs(i,{children:[e.jsx(l,{children:"Deskripsi Singkat"}),e.jsx(B,{...a,value:a.value??"",placeholder:"Deskripsi singkat produk (maks 500 karakter)",maxLength:500,autoComplete:"off"}),e.jsx(d,{})]})}),e.jsx(o,{control:n.control,name:"description",render:({field:a})=>e.jsxs(i,{children:[e.jsx(l,{children:"Deskripsi Lengkap"}),e.jsx(B,{...a,value:a.value??"",placeholder:"Deskripsi lengkap produk",rows:6,autoComplete:"off"}),e.jsx(d,{})]})}),e.jsx(o,{control:n.control,name:"key_points",render:({field:a})=>e.jsxs(i,{children:[e.jsx(l,{children:"Poin-Poin Penting"}),e.jsx(Ce,{apiKey:"c7quf44sjov5dzvyzvgh4sryhheoi9t6vikfbzqk61pzpi77",value:a.value??"",onEditorChange:r=>a.onChange(r),init:{plugins:["anchor","autolink","charmap","codesample","emoticons","image","link","lists","media","searchreplace","table","visualblocks","wordcount"],toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat",height:300,menubar:!1}}),e.jsx(u,{children:"Format poin-poin penting dengan bullet list atau numbering"}),e.jsx(d,{})]})}),e.jsx(o,{control:n.control,name:"thumbnail",render:({field:a})=>e.jsxs(i,{children:[e.jsx(l,{children:"Thumbnail"}),e.jsx("img",{src:E||(s.thumbnail?`/storage/${s.thumbnail}`:"/assets/images/placeholder.png"),alt:s.title,className:"my-1 mt-2 h-56 rounded border object-cover"}),e.jsx(p,{type:"file",name:a.name,accept:"image/png, image/jpeg, image/jpg, image/webp",className:Y?"border-red-500 focus-visible:ring-red-500":"",onChange:r=>{var x;const t=((x=r.target.files)==null?void 0:x[0])??null;if(t){if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(t.type)){C(!0),G.error("Gambar harus png, jpg, jpeg, atau webp");return}if(t.size>2*1024*1024){C(!0),G.error("Ukuran file maksimal 2MB!");return}}if(C(!1),a.onChange(t),t){const c=new FileReader;c.onload=g=>{var f;return R((f=g.target)==null?void 0:f.result)},c.readAsDataURL(t)}else R(null)}}),e.jsx(u,{children:"Format: PNG, JPG, JPEG, WEBP. Maksimal 2MB"}),e.jsx(d,{})]})})]}),e.jsxs("div",{className:"space-y-6 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{size:16}),e.jsx("h3",{className:"font-medium",children:"Harga, Jadwal & URL"})]}),e.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(he,{id:"show-strikethrough",checked:F,onCheckedChange:a=>{q(a),a||n.setValue("strikethrough_price",0)}}),e.jsx(ue,{htmlFor:"show-strikethrough",children:"Aktifkan Harga Coret (Opsional)"})]}),F&&e.jsx(o,{control:n.control,name:"strikethrough_price",render:({field:a})=>e.jsxs(i,{children:[e.jsx(l,{children:"Harga Coret"}),e.jsx(p,{...a,type:"text",placeholder:"Rp 0",value:A.format(a.value||0),onChange:r=>a.onChange(K(r.target.value)),autoComplete:"off"}),e.jsx(u,{children:"Harga asli yang akan ditampilkan tercoret."}),e.jsx(d,{})]})})]}),e.jsx(o,{control:n.control,name:"price",render:({field:a})=>e.jsxs(i,{children:[e.jsxs(l,{children:["Harga ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{...a,type:"text",placeholder:"Masukkan harga produk",value:A.format(a.value||0),onChange:r=>a.onChange(K(r.target.value)),autoComplete:"off"}),e.jsx(d,{})]})}),e.jsx(o,{control:n.control,name:"type",render:({field:a})=>e.jsxs(i,{className:"space-y-3",children:[e.jsxs(l,{children:["Tipe Kategori ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{children:e.jsxs(pe,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex-col space-y-1",children:[e.jsxs(i,{className:"flex items-center space-y-0 space-x-3",children:[e.jsx(m,{children:e.jsx(O,{value:"regular"})}),e.jsx(l,{className:"font-normal",children:"Reguler"})]}),e.jsxs(i,{className:"flex items-center space-y-0 space-x-3",children:[e.jsx(m,{children:e.jsx(O,{value:"scholarship"})}),e.jsx(l,{className:"font-normal",children:"Beasiswa"})]})]})}),e.jsx(u,{children:"Pilih apakah produk ini termasuk program reguler atau beasiswa."}),e.jsx(d,{})]})}),n.watch("type")==="scholarship"&&e.jsxs(e.Fragment,{children:[e.jsx(o,{control:n.control,name:"scholarship_group_link",render:({field:a})=>e.jsxs(i,{children:[e.jsxs(l,{children:["Link Grup WhatsApp/Telegram ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{children:e.jsx(p,{...a,type:"url",placeholder:"https://chat.whatsapp.com/xxxxx atau https://t.me/xxxxx",value:a.value??""})}),e.jsx(u,{children:"Link grup WhatsApp atau Telegram untuk peserta beasiswa yang diterima."}),e.jsx(d,{})]})}),e.jsx(o,{control:n.control,name:"event_deadline",render:({field:a})=>e.jsxs(i,{className:"flex flex-col",children:[e.jsx(l,{children:"Batas Waktu Event (Opsional)"}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsxs(N,{open:X,onOpenChange:I,children:[e.jsx(w,{asChild:!0,children:e.jsx(m,{children:e.jsxs(y,{variant:"outline",className:k("w-full flex-1 justify-start pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?_(a.value,"PPP",{locale:W}):e.jsx("span",{children:"Pilih tanggal"}),e.jsx(T,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(P,{className:"w-auto p-0",align:"start",children:e.jsx(U,{mode:"single",selected:a.value??void 0,captionLayout:"dropdown",endMonth:new Date(new Date().getFullYear()+10,11),onSelect:r=>{if(!r){a.onChange(null);return}const t=v(a.value);a.onChange(b(r,t)),I(!1)},disabled:r=>{const t=new Date;return t.setHours(0,0,0,0),r<t},initialFocus:!0})})]}),e.jsx(m,{children:e.jsx(p,{type:"time",className:"w-full sm:w-36",value:v(a.value),disabled:!a.value,onChange:r=>{a.value&&a.onChange(b(a.value,r.target.value))}})})]}),e.jsx(u,{children:"Deadline event/agenda untuk program beasiswa (jika ada)."}),e.jsx(d,{})]})}),e.jsx(o,{control:n.control,name:"payment_code",render:({field:a})=>e.jsxs(i,{children:[e.jsx(l,{children:"Kode Pembayaran (Opsional)"}),e.jsx(m,{children:e.jsx(p,{...a,value:a.value??"",placeholder:"Contoh: PAY-ABC123",autoComplete:"off"})}),e.jsx(u,{children:"Kode pembayaran untuk kebutuhan internal/integrasi."}),e.jsx(d,{})]})})]}),e.jsxs("div",{className:"space-y-4 rounded-md border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("h4",{className:"font-medium",children:"Informasi Jadwal"})]}),e.jsx(o,{control:n.control,name:"registration_deadline",render:({field:a})=>e.jsxs(i,{className:"flex flex-col",children:[e.jsxs(l,{children:["Batas Waktu Pendaftaran ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsxs(N,{open:Q,onOpenChange:H,children:[e.jsx(w,{asChild:!0,children:e.jsx(m,{children:e.jsxs(y,{variant:"outline",className:k("w-full flex-1 justify-start pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?_(a.value,"PPP",{locale:W}):e.jsx("span",{children:"Pilih tanggal"}),e.jsx(T,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(P,{className:"w-auto p-0",align:"start",children:e.jsx(U,{mode:"single",selected:a.value,captionLayout:"dropdown",endMonth:new Date(new Date().getFullYear()+10,11),onSelect:r=>{if(!r)return;const t=v(a.value);a.onChange(b(r,t)),H(!1)},disabled:r=>{const t=new Date;return t.setHours(0,0,0,0),r<t},initialFocus:!0})})]}),e.jsx(m,{children:e.jsx(p,{type:"time",className:"w-full sm:w-36",value:v(a.value),disabled:!a.value,onChange:r=>{a.value&&a.onChange(b(a.value,r.target.value))}})})]}),e.jsx(u,{children:"Tanggal terakhir untuk melakukan pendaftaran"}),e.jsx(d,{})]})}),e.jsx(o,{control:n.control,name:"schedule_days",render:()=>e.jsxs(i,{children:[e.jsxs(l,{children:["Hari Pelaksanaan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{children:"Pilih hari-hari pelaksanaan program"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Se.map(a=>e.jsx(o,{control:n.control,name:"schedule_days",render:({field:r})=>{var t;return e.jsxs(i,{className:"flex flex-row items-center space-y-0 space-x-3",children:[e.jsx(m,{children:e.jsx(se,{checked:(t=r.value)==null?void 0:t.includes(a.value),onCheckedChange:x=>{var c;return x?r.onChange([...r.value||[],a.value]):r.onChange((c=r.value)==null?void 0:c.filter(g=>g!==a.value))}})}),e.jsx(l,{className:"cursor-pointer font-normal",children:a.label})]},a.value)}},a.value))}),e.jsx(d,{})]})}),e.jsx(o,{control:n.control,name:"duration_days",render:({field:a})=>e.jsxs(i,{children:[e.jsx(l,{children:"Durasi Program (Hari)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"text-muted-foreground h-4 w-4"}),e.jsx(m,{children:e.jsx(p,{type:"number",placeholder:"0",min:"0",...a,value:a.value??0,onChange:r=>a.onChange(r.target.value?parseInt(r.target.value):0),autoComplete:"off",className:"flex-1"})})]}),e.jsx(u,{children:"Total durasi program dalam hari (kosongkan jika tidak ada)"}),e.jsx(d,{})]})})]}),e.jsx(o,{control:n.control,name:"registration_url",render:({field:a})=>e.jsxs(i,{children:[e.jsxs(l,{children:["URL Pendaftaran Eksternal ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{...a,value:a.value??"",type:"url",placeholder:"https://partner.com/register",autoComplete:"off"}),e.jsx(u,{children:"URL untuk mengarahkan user mendaftar/membeli produk di website partner"}),e.jsx(d,{})]})}),e.jsxs("div",{className:"rounded-md border border-gray-200 bg-gray-50 p-4",children:[e.jsx("h4",{className:"mb-2 font-medium text-gray-900",children:"Status Produk"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsx("div",{className:k("w-fit rounded-full border px-3 py-1",s.status==="draft"&&"border-gray-200 bg-gray-100 text-gray-700",s.status==="published"&&"border-green-200 bg-green-100 text-green-700",s.status==="archived"&&"border-red-200 bg-red-100 text-red-700"),children:e.jsxs("span",{className:"font-medium capitalize",children:[s.status==="draft"&&"Draft",s.status==="published"&&"Terbit",s.status==="archived"&&"Arsip"]})}),e.jsx("p",{className:"text-muted-foreground pt-2 text-xs",children:"Ubah status produk di halaman detail setelah menyimpan perubahan."})]})]}),e.jsxs("div",{className:"rounded-md border border-amber-200 bg-amber-50 p-4",children:[e.jsx("h4",{className:"mb-2 font-medium text-amber-900",children:"Informasi Penting"}),e.jsxs("ul",{className:"list-inside list-disc space-y-1 text-sm text-amber-800",children:[e.jsx("li",{children:"Produk ini tidak dijual di platform"}),e.jsx("li",{children:"User akan diarahkan ke URL pendaftaran eksternal"}),e.jsx("li",{children:"Setiap klik akan dicatat untuk statistik"}),e.jsx("li",{children:"Pastikan URL pendaftaran valid dan aktif"})]})]})]}),e.jsx(y,{type:"submit",className:"hover:cursor-pointer lg:col-span-2",children:"Simpan Perubahan"})]})})]})]})}export{Oa as default};
